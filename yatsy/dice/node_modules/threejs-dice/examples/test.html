<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<script src="../../three/build/three.js"></script>
    <script src="../../cannon/build/cannon.js"></script>
    <script src="../../three/examples/js/controls/OrbitControls.js"></script>
    <script src="../../three/examples/js/libs/stats.min.js"></script>
    <script src="../lib/dice.js"></script>
</head>
<body>
<div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div>


    
<script>
    // Setup your threejs scene
   
    var container, camera, renderer, controls, stats,scene, world,dice;

    init(); 
    animate();

    function init(){
    scene = new THREE.Scene();
    stats = new Stats();
	stats.domElement.style.position = 'absolute';
	stats.domElement.style.bottom = '0px';
    stats.domElement.style.zIndex = 100;
    container = document.getElementById( 'ThreeJS' );
	container.appendChild( stats.domElement );
    
    // RENDERER
	renderer = new THREE.WebGLRenderer( {antialias:true} );
	renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
    // LIGHT
	var light = new THREE.PointLight(0xffffff, 0.8);
	light.position.set(0,150,100);
	scene.add(light);
	// LIGHT
	var light = new THREE.PointLight(0xffffff, 0.8);
	light.position.set(-400,150,100);
	scene.add(light);
	// LIGHT
	var light = new THREE.PointLight(0xffffff, 0.8);
	light.position.set(400,150,100);
	scene.add(light);
	// FLOOR
	var floorMaterial = new THREE.MeshPhongMaterial( { color: '#00aa00', side: THREE.DoubleSide } );
	var floorGeometry = new THREE.PlaneGeometry(1000, 1000, 10, 10);
	var floor = new THREE.Mesh(floorGeometry, floorMaterial);
	floor.position.y = -0.5;
	floor.rotation.x = Math.PI / 2;
	scene.add(floor);
	// SKYBOX/FOG
	var skyBoxGeometry = new THREE.CubeGeometry( 10000, 10000, 10000 );
	var skyBoxMaterial = new THREE.MeshPhongMaterial( { color: 0x9999ff, side: THREE.BackSide } );
	var skyBox = new THREE.Mesh( skyBoxGeometry, skyBoxMaterial );
	// scene.add(skyBox);
	scene.fog = new THREE.FogExp2( 0x9999ff, 0.00025 );

	////////////
	// CUSTOM //
	////////////
    world = new CANNON.World();

    world.gravity.set(0, 0, -9.8 * 800);
    world.broadphase = new CANNON.NaiveBroadphase();
    world.solver.iterations = 16;


    //create camera
    var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
	var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
    camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
    scene.add(camera);
    camera.position.set(100, 500, 300);
	camera.rotation.x = -0.95;
    
    // Setup your cannonjs world
     world = new CANNON.World();
    // ...
    
    DiceManager.setWorld(world);
    
    // Create a dice
    dice = new DiceD6({backColor: '#ff0000'}); //DiceD6 for six-sided dice; for options see DiceObject
    scene.add(dice.getObject());
    
    // If you want to place the mesh somewhere else, you have to update the body
    dice.getObject().position.x = 150;
    dice.getObject().position.y = 100;
    dice.getObject().rotation.x = 20 * Math.PI / 180;
    dice.updateBodyFromMesh();
    
    // Set the value of the side, which will be upside after the dice lands
    DiceManager.prepareValues([{dice: dice, value: 6}]);
    }
    //Animate everything
    function animate() {
        world.step(1.0 / 60.0);
        
        dice.updateMeshFromBody(); // Call this after updating the physics world for rearranging the mesh according to the body
        
        renderer.render(scene, camera);
        
        requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);
    
</script>
</body>
</html>